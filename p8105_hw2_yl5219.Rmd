---
title: "p8105_hw2_yl5219"
author: "Yuqing Liu"
date: "2023-09-27"
output: github_document
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r library, include=FALSE}
library(tidyverse)
library(readxl)
```

# Problem 1
### pols-month.csv
clean the data in pols-month and check the first six rows using `head()`:
```{r import and clean pols-month.csv dataset}
pols_month = read.csv(file = "./fivethirtyeight_datasets/pols-month.csv") |> janitor::clean_names() |>
  separate(mon, into = c("year", "month", "day"))|>
  mutate(
    month =
      case_match(
        month,
        "01" ~ "jan",
        "02" ~ "feb",
        "03" ~ "mar",
        "04" ~ "apr",
        "05" ~ "may",
        "06" ~ "jun",
        "07" ~ "jul",
        "08" ~ "aug",
        "09" ~ "sep",
        "10" ~ "oct",
        "11" ~ "nov",
        "12" ~ "dec")
      )|>
  mutate(president=case_match(
           prez_dem,
           1~"democratic",
           0~"republican"))  |>
  select(-prez_dem, -prez_gop, -day)

head(pols_month)
```


### snp.csv
clean and check the data in snp:
```{r import and clean snp.csv dataset}
snp = read.csv(file = "./fivethirtyeight_datasets/snp.csv")|>
  janitor::clean_names()|>
  separate(date, into = c("month", "day", "year"))|>
  mutate(
    month =
      case_match(
        month,
        "1" ~ "jan",
        "2" ~ "feb",
        "3" ~ "mar",
        "4" ~ "apr",
        "5" ~ "may",
        "6" ~ "jun",
        "7" ~ "jul",
        "8" ~ "aug",
        "9" ~ "sep",
        "10" ~ "oct",
        "11" ~ "nov",
        "12" ~ "dec")
      )|>select(-day)|>
  select(year, month, everything())

head(snp)
```

### unemployment.csv
clean and check the data in unemployment:
```{r import and clean unemployment.csv dataset}
unemployment = read.csv(file = "./fivethirtyeight_datasets/unemployment.csv")|>
  janitor::clean_names()|>
  pivot_longer(
    jan:dec,
    names_to = "month",
    values_to = "unemployment")|>
    mutate(year=as.character(year))

head(unemployment)
```
### merge datasets
join the datasets:
```{r}
df=pols_month|>
  left_join(snp,by=c("year", "month"))|>
  left_join(unemployment, by=c("year", "month"))

head(df)
```

### discussion
* The dataset `pols_month` contains `r nrow(pols_month)` rows and `r ncol(pols_month)` columns. It contains variables including `year`, `month`, `gov_gop`, `sen_gop`, `rep_gop`, `gov_dem`, `sen_dem`, `rep_dem`, `president`. The range of `year` is from `r min(pols_month$year)` to `r max(pols_month$year)`.

* The dataset `snp` contains `r nrow(snp)` rows and `r ncol(snp)` columns. It contains variables including `year`, `month`, `close`.The range of `year` is from `r min(snp$year)` to `r max(snp$year)`.

* The dataset `unemployment` contains `r nrow(unemployment)` rows and `r ncol(unemployment)` columns. It contains variables including `year`, `month`, `unemployment`.The range of `year` is from `r min(unemployment$year)` to `r max(unemployment$year)`.

* The merged dataset `df` contains `r nrow(df)` rows and `r ncol(df)` columns. It contains variables including `year`, `month`, `gov_gop`, `sen_gop`, `rep_gop`, `gov_dem`, `sen_dem`, `rep_dem`, `president`, `close`.The range of `year` is from `r min(df$year)` to `r max(df$year)`.


# Problem 2
### Mr.Trash Wheel

Below we read and clean Mr. Trash Wheel dataset:

* specify the sheet in the Excel file and to omit non-data entries (rows with notes / figures; columns containing notes) using arguments in `read_excel()`
* use reasonable variable names by `janitor::clean_names()`
* omit rows that do not include dumpster-specific data by ` filter(row_number() <= n()-1)` to delete the last row
* Home power notes mentioned each ton of trash equates to on average 500 kilowatts of electricity and an average household will use 30 kilowatts per day. Based on this information, we can calculate the number of homes powered by Mr. Trash Wheel `homes_powered` by `mutate(homes_powered=weight_tons*500/30)`.

```{r}
mr_trash_wheel = read_excel("./202309 Trash Wheel Collection Data.xlsx", 
                            sheet="Mr. Trash Wheel", 
                            range = cell_cols("A:N"))|>
  janitor::clean_names()|> 
  filter(row_number() <= n()-1)|>
  mutate(homes_powered=weight_tons*500/30)

mr_trash_wheel
```

### Professor Trash Wheel

We use the same methods for Professor Trash Wheel sheet:

* specify the sheet in the Excel file and to omit non-data entries (rows with notes / figures; columns containing notes) using arguments in `read_excel()`
* use reasonable variable names by `janitor::clean_names()`
* omit rows that do not include dumpster-specific data by ` filter(row_number() <= n()-1)` to delete the last row
* Home power notes mentioned each ton of trash equates to on average 500 kilowatts of electricity and an average household will use 30 kilowatts per day. Based on this information, we can calculate the number of homes powered by Mr. Trash Wheel `homes_powered` by `mutate(homes_powered=weight_tons*500/30)`.

```{r message=FALSE}
professor_trash_wheel = read_excel("./202309 Trash Wheel Collection Data.xlsx", 
                                   sheet="Professor Trash Wheel", 
                                   range = cell_cols("A:M"))|>
  janitor::clean_names()|> 
  filter(row_number() <= n()-1)|>
  mutate(homes_powered=weight_tons*500/30)

professor_trash_wheel
```

### Gwynnda

We use the same methods for Gwynnda Trash Wheel sheet:

* specify the sheet in the Excel file and to omit non-data entries (rows with notes / figures; columns containing notes) using arguments in `read_excel()`
* use reasonable variable names by `janitor::clean_names()`
* omit rows that do not include dumpster-specific data by ` filter(row_number() <= n()-2)` to delete the last two rows
* Home power notes mentioned each ton of trash equates to on average 500 kilowatts of electricity and an average household will use 30 kilowatts per day. Based on this information, we can calculate the number of homes powered by Mr. Trash Wheel `homes_powered` by `mutate(homes_powered=weight_tons*500/30)`.

```{r message=FALSE}
gwynnda_trash_wheel = read_excel("./202309 Trash Wheel Collection Data.xlsx", 
                                   sheet="Gwynnda Trash Wheel", 
                                   range = cell_cols("A:L"))|>
  janitor::clean_names()|> 
  filter(row_number() <= n()-2)|>
  mutate(homes_powered=weight_tons*500/30)

gwynnda_trash_wheel
```

